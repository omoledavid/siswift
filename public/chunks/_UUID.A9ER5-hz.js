import{_ as F,b as o,d as e,e as u,w,r as v,o as i,F as L,h as U,t as a,k as l,n as V,f as B}from"../entry/index.wkIW-Yay.js";const N={data(){return{orderID:this.$route.params.order_id,item:{},loading:!1,order:{},escrow:[],orderData:{},items:[],product:{},can_return:!0,visible:!1,orderDetail:{}}},methods:{getOrder(){this.loading=!0,this.$orders.viewOrderRecord(this.orderID).then(r=>{this.order=r.order,this.product=r.order.product,this.orderDetail=r.order_detail,this.escrowList()})},viewReceipt(){this.visible=!0},escrowList(){this.$orders.allEscrow().then(r=>{let p=r.data.find(b=>this.order.order_id==b.order_id);this.orderData=p||{}}).finally(()=>{this.loading=!1})},rejectEscrow(){this.$orders.rejectEscrow(this.orderData.id).then(r=>(this.escrowList(),r))},acceptEscrow(){this.$orders.acceptEscrow(this.orderData.id).then(r=>(this.escrowList(),r))},completeTransaction(){this.$orders.completeEscrow(this.orderData.id).then(r=>(this.escrowList(),r))},onCountdownEnd(){this.can_return=!1}},beforeMount(){this.getOrder()},computed:{user(){return this.$store.getters["auth/getUser"]},totalAmount(){return this.order.base_price*this.order.quantity},isSeller(){let r=null;return r=this.user.seller_id==this.order.seller_id,r},isEndDate(){var r=new Date(this.order.order.updated_at),s=new Date(r.getTime()+1*24*60*60*1e3);return s},countdownDate(){var r=new Date(this.order.order.updated_at);const s=new Date;var p=r.getTime()+1*24*60*60*1e3-s.getTime(),b=p<=0?0:p;return b}}},S={class:"body-content w-full lg:page-bg md:page-bg"},I={class:"flex justify-between gap-12 mb-3"},M={class:"grid grid-cols-3 w-full gap-4"},O={class:"flex gap-4"},Q=e("span",{class:"bg-accent text-xs p-2 block mb-2 w-fit"}," Ensure the buyer or seller confirms receipt or delivery of the item before you depart from the meet up location. ",-1),z={class:"mt-4 flex flex-col gap-1"},P={class:"flex gap-2"},G=["src"],H={class:"flex gap-[4px] flex-col"},J={class:"font-semibold block"},K={class:"block text-sm"},W={class:"block text-[13px]"},X={key:0,class:"mt-4"},Y={class:"flex gap-2 items-center mb-3"},Z={key:1,class:"bg-green-600 text-white rounded-[3px] px-3 py-[6px] text-[12px]"},$={class:"flex justify-between items-center gap-4"},ee={class:"font-bold text-xl text-primary"},te={key:0,class:"rejected px-3 py-[6px] text-[12px]"},re={key:2,class:"pending"},se={key:3},oe={key:1,class:"mt-4"},ie={class:"flex gap-2 items-center mb-3"},ne={key:0,class:"bg-green-600 text-white rounded-[3px] px-3 py-[6px] text-[12px]"},de={class:"flex lg:flex-row md:flex-row flex-col justify-between items-center gap-4"},le={class:"font-bold text-xl text-primary"},ae={key:0,class:"rejected px-3 py-[6px] text-[12px]"},ce={key:2,class:"pending"},ue={key:3,class:"flex gap-3 lg:flex-row md:flex-row flex-col lg:items-center md:items-center lg:mt-0 md:mt-0 mt-3"},pe=["disabled"],me={key:0},_e={class:"p-4"},he=e("h4",{class:"text-sm font-semibold"},"Receipt",-1),xe={class:"flex gap-2"},be=["src"],ge={class:"flex gap-[4px] flex-col"},we={class:"font-semibold block"},ve={class:"block text-sm"},ye={class:"block text-[13px]"};function fe(r,s,p,b,t,n){const g=v("el-skeleton-item"),j=v("vue-countdown"),R=v("el-skeleton"),T=v("vDialog");return i(),o("div",null,[e("div",S,[u(R,{loading:t.loading,animated:""},{template:w(()=>[e("div",null,[u(g,{variant:"image",style:{height:"100px","margin-bottom":"20px","border-radius":"10px"}}),e("div",I,[e("div",M,[(i(),o(L,null,U(3,c=>e("div",{class:"",key:c},[u(g,{variant:"image",style:{height:"50px","border-radius":"4px"}})])),64))]),e("span",O,[u(g,{variant:"text",style:{height:"50px",width:"50px","border-radius":"10px"}}),u(g,{variant:"text",style:{height:"50px",width:"50px","border-radius":"10px"}})])])])]),default:w(()=>{var c,m,_,h,x,y,f,D,k,E,C;return[e("div",null,[Q,e("div",null,[e("div",z,[e("div",P,[e("img",{src:r.imgUrl+"product/"+((c=t.product)==null?void 0:c.main_image),alt:"",role:"button",class:"h-[80px] w-[60px] object-contain rounded-lg"},null,8,G),e("div",H,[e("span",J,a((m=t.product)==null?void 0:m.name),1),e("span",K,a(r.$currencyFormat((_=t.order)==null?void 0:_.base_price)),1),e("span",W,"Qty: "+a((h=t.order)==null?void 0:h.quantity),1)])]),n.isSeller?(i(),o("div",X,[e("div",Y,[((x=t.orderData)==null?void 0:x.status)==="initiated"?(i(),o("button",{key:0,class:"bg-red-600 text-white rounded-[3px] px-3 py-[6px] text-[12px]",onClick:s[0]||(s[0]=(...d)=>n.rejectEscrow&&n.rejectEscrow(...d))}," Cancel ")):l("",!0),t.orderData.status==="delivered"&&t.can_return?(i(),o("button",Z," Messages ")):l("",!0),t.orderData.status==="delivered"?(i(),o("button",{key:2,class:"bg-amber-600 text-white rounded-[3px] px-3 py-[6px] text-[12px]",onClick:s[1]||(s[1]=(...d)=>n.viewReceipt&&n.viewReceipt(...d))}," View Receipt ")):l("",!0)]),e("div",$,[e("h4",ee,a(r.$currencyFormat(n.totalAmount)),1),((y=t.orderData)==null?void 0:y.status)==="rejected"?(i(),o("span",te,"Escrow Rejected")):l("",!0),((f=t.orderData)==null?void 0:f.status)==="initiated"?(i(),o("button",{key:1,class:"text-white brand-btn-md bg-primary",onClick:s[2]||(s[2]=(...d)=>n.acceptEscrow&&n.acceptEscrow(...d))}," Accept & Deliver ")):l("",!0),((D=t.orderData)==null?void 0:D.status)==="confirmed"?(i(),o("span",re," Awaiting Buyer Confirmation ")):l("",!0),((k=t.orderData)==null?void 0:k.status)==="delivered"?(i(),o("div",se,[e("button",{class:"text-white brand-btn-md bg-primary",onClick:s[3]||(s[3]=d=>r.$router.push("/app/user/review/"+this.orderData.buyer_id))}," Review Buyer ")])):l("",!0)])])):(i(),o("div",oe,[e("div",ie,[t.orderData.status==="delivered"&&t.can_return?(i(),o("button",ne," Messages ")):l("",!0),t.orderData.status==="delivered"?(i(),o("button",{key:1,class:"bg-amber-600 text-white rounded-[3px] px-3 py-[6px] text-[12px]",onClick:s[4]||(s[4]=(...d)=>n.viewReceipt&&n.viewReceipt(...d))}," View Receipt ")):l("",!0)]),e("div",de,[e("h4",le,a(`${r.$currencyFormat(n.totalAmount)}`),1),((E=t.orderData)==null?void 0:E.status)==="rejected"?(i(),o("span",ae,"Escrow Rejected")):l("",!0),t.orderData.status==="confirmed"?(i(),o("button",{key:1,class:"text-white brand-btn-md bg-primary",onClick:s[5]||(s[5]=(...d)=>n.completeTransaction&&n.completeTransaction(...d))}," Received ")):l("",!0),((C=t.orderData)==null?void 0:C.status)==="initiated"?(i(),o("span",ce," Awaiting Seller Confirmation ")):l("",!0),t.orderData.status==="delivered"?(i(),o("div",ue,[e("button",{class:"text-white brand-btn-md py-[8px] bg-primary",onClick:s[6]||(s[6]=d=>r.$router.push("/app/user/review/"+this.orderData.seller_id))}," Review "),e("button",{onClick:s[7]||(s[7]=d=>r.$router.push(`/app/dispute/${t.orderDetail.id}/submit?amount=${Number(t.orderDetail.total_amount)}&seller=${t.orderDetail.seller_id}`)),disabled:!t.can_return,class:V(["text-white brand-btn-md",t.can_return?"bg-primary":"bg-gray-500 border border-gray-500"])},[B(" Return Product "),t.can_return?(i(),o("span",me,[u(j,{time:n.countdownDate,onEnd:n.onCountdownEnd},{default:w(({hours:d,minutes:q,seconds:A})=>[e("span",null,a(`(${d}hours, ${q}mins, ${A}secs)`),1)]),_:1},8,["time","onEnd"])])):l("",!0)],10,pe)])):l("",!0)])]))])])])]}),_:1},8,["loading"])]),u(T,{visible:t.visible,"onUpdate:visible":s[8]||(s[8]=c=>t.visible=c),modal:"",style:{width:"25rem"},pt:{root:"border-none",mask:{style:"backdrop-filter: blur(2px)"}}},{container:w(({closeCallback:c})=>{var m,_,h,x;return[e("div",_e,[he,e("div",xe,[e("img",{src:r.imgUrl+"product/"+((m=t.product)==null?void 0:m.main_image),alt:"",role:"button",class:"h-[80px] w-[60px] object-contain rounded-lg"},null,8,be),e("div",ge,[e("span",we,a((_=t.product)==null?void 0:_.name),1),e("span",ve,a(r.$currencyFormat((h=t.order)==null?void 0:h.base_price)),1),e("span",ye,"Qty: "+a((x=t.order)==null?void 0:x.quantity),1)])])])]}),_:1},8,["visible","pt"])])}const ke=F(N,[["render",fe]]);export{ke as default};
