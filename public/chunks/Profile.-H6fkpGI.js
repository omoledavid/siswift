import{_ as k,l as C,u as L,b as n,d as t,F as g,h as _,e as i,f as P,t as f,n as x,w as y,k as w,r as u,o as r,v as S,D as F,A as j}from"../entry/index.wkIW-Yay.js";import{R as N}from"./ReviewCard.CUfCb_jx.js";const R={components:{ReviewCard:N},data(){return{form:{firstname:"",lastname:"",mobile:"",address:"",image:"",state:"",city:""},tabs:[{label:"profile"},{label:"reviews"}],states:[],lgas:[],isLoading:!1,isUploading:!1,image:C,activeTab:0,reviews:[]}},methods:{editProfile(){this.isLoading=!0;const e=new FormData;e.append("_method","PUT"),e.append("firstname",this.form.firstname),e.append("lastname",this.form.lastname),e.append("email",this.form.email),e.append("mobile",this.form.phone),e.append("address",this.form.address),e.append("state",this.form.state),e.append("city",this.form.city),e.append("country","Nigeria"),this.$auth.updateProfile(e,this.user.id).then(a=>{console.log("register res:",a),this.getUser()}).finally(()=>{this.isLoading=!1})},uploadPhoto(){let a=event.target.files[0];this.isUploading=!0;const l=new FormData;l.append("_method","PUT"),l.append("firstname",this.form.firstname),l.append("lastname",this.form.lastname),l.append("email",this.form.email),l.append("mobile",this.form.phone),l.append("address",this.form.address),l.append("state",this.form.state),l.append("city",this.form.city),l.append("image",a),this.$auth.updateProfile(l,this.user.id).then(b=>{console.log("register res:",b),this.getUser()}).finally(()=>{this.isUploading=!1})},getUser(){this.$auth.getProfile().then(e=>{console.log(e.profile),this.$store.commit("auth/setUser",e.profile)})},getReviews(){this.$user.getReviews().then(e=>{console.log(e),this.reviews=e.reviews})},async getStates(){try{const e=await this.$axios.get("https://nga-states-lga.onrender.com/fetch");console.log(e.data),this.states=e.data}catch(e){console.log(e)}},async getLGA(){try{const e=await this.$axios.get(`https://nga-states-lga.onrender.com/?state=${this.form.state}`);console.log(e.data),this.lgas=e.data}catch(e){console.log(e)}},activateMenu(e){this.activeTab=e}},beforeMount(){this.getStates(),this.getUser(),this.form.state&&this.getLGA(),this.getReviews()},watch:{user:{handler(e){this.form={firstname:e.firstname,lastname:e.lastname,mobile:e.mobile,address:e.address.address,state:e.address.state,city:e.address.city}},immediate:!0},"form.state":{handler:L.debounce(function(){this.getLGA()},300)}},computed:{user(){return this.$store.getters["auth/getUser"]}}},T={class:"lg:page-bg md:page-bg lg:w-6/12 md:w-7/12 w-full mx-auto mt-6"},q={class:"border-b border-b-gray-400 w-full flex gap-6 justify-center mb-4"},M=["onClick"],A={key:0},D={class:"flex items-center flex-col mb-3"},B={class:"relative"},E=["src"],G={for:"fileInput",class:"file-label mb-0 flex flex-col items-center bg-primary text-white p-[8px] rounded-full absolute right-0 bottom-0"},z={class:"font-semibold flex items-center mt-3"},I={class:"flex lg:flex-row md:flex-row flex-col gap-[8px]"},H={class:"w-full"},K=t("label",{for:""},"First Name",-1),Y={class:"w-full"},J=t("label",{for:""},"Last Name",-1),O=t("label",{for:""},"Home Address",-1),Q={class:"flex lg:flex-row md:flex-row flex-col items-center gap-2"},W={class:"w-full"},X=t("label",{for:""},"State",-1),Z=t("option",{selected:"",disabled:"",value:""},"--Select State--",-1),$=["value"],ee={class:"w-full"},te=t("label",{for:""},"City",-1),se=t("option",{selected:"",disabled:"",value:""},"--Select City--",-1),oe=["value"],ae={class:"text-center mt-2"},ie=["disabled"],le={key:1},re=t("div",{class:"mt-3"},null,-1),ne=t("h4",{class:"font-semibold mt-3"},"Verification",-1),de={class:"font-medium text-sm flex gap-2 items-center"},ce={class:"flex flex-col"},me=t("span",null,"KYC Verification",-1),pe={class:"text-xs text-gray-500"},fe={key:1,class:""};function ue(e,a,l,b,s,d){var v;const m=u("i-icon"),h=u("vField"),p=u("ErrorMessage"),V=u("vForm"),U=u("review-card");return r(),n("div",null,[t("div",T,[t("span",q,[(r(!0),n(g,null,_(s.tabs,(c,o)=>(r(),n("span",{key:o,role:"button",class:x(["capitalize text-[14px] text-center",{"border-b text-primary border-b-primary font-semibold":s.activeTab===o}]),onClick:he=>d.activateMenu(o)},f(c.label.split("_").join(" ")),11,M))),128))]),s.activeTab=="0"?(r(),n("div",A,[t("div",D,[t("div",B,[t("img",{src:d.user.image?`${e.imgUrl}user/profile/${d.user.image}`:s.image,class:"w-[80px] h-[80px] border-2 p-[2px] border-gray-100 rounded-full object-fit object-top"},null,8,E),t("input",{type:"file",name:"file",id:"fileInput",class:"hidden-input",ref:"file",accept:".png,.jpg,.jpeg,.webp,.svg",onChange:a[0]||(a[0]=(...c)=>d.uploadPhoto&&d.uploadPhoto(...c))},null,544),t("label",G,[i(m,{icon:s.isUploading?"line-md:downloading-loop":"lucide:images",class:"text-[15px]"},null,8,["icon"])])]),t("h4",z,[P(f(`${s.form.firstname} ${s.form.lastname}`)+" ",1),t("span",null,[i(m,{icon:"ic:round-verified",class:x([(v=d.user)!=null&&v.kv?"text-green-600":"text-gray-400"])},null,8,["class"])])])]),i(V,{class:"flex flex-col justify-between gap-[8px]",onSubmit:d.editProfile},{default:y(({meta:c})=>[t("div",I,[t("div",H,[K,i(h,{name:"firstname",class:"input",modelValue:s.form.firstname,"onUpdate:modelValue":a[1]||(a[1]=o=>s.form.firstname=o),type:"text",rules:"required|alpha"},null,8,["modelValue"]),i(p,{name:"firstname",class:"text-xs text-error"})]),t("div",Y,[J,i(h,{name:"lastname",class:"input",modelValue:s.form.lastname,"onUpdate:modelValue":a[2]||(a[2]=o=>s.form.lastname=o),type:"text",rules:"required|alpha"},null,8,["modelValue"]),i(p,{name:"lastname",class:"text-xs text-error"})])]),t("div",null,[O,i(h,{as:"textarea",name:"address",class:"input",modelValue:s.form.address,"onUpdate:modelValue":a[3]||(a[3]=o=>s.form.address=o),rules:"required"},null,8,["modelValue"]),i(p,{name:"address",class:"text-xs text-error"})]),t("div",Q,[t("div",W,[X,i(h,{as:"select",name:"state",class:"input",modelValue:s.form.state,"onUpdate:modelValue":a[4]||(a[4]=o=>s.form.state=o),rules:"required"},{default:y(()=>[Z,(r(!0),n(g,null,_(s.states,o=>(r(),n("option",{key:o,value:o},f(o),9,$))),128))]),_:1},8,["modelValue"]),i(p,{name:"state",class:"text-xs text-error"})]),t("div",ee,[te,S(t("select",{name:"city","onUpdate:modelValue":a[5]||(a[5]=o=>s.form.city=o),class:"input"},[se,(r(!0),n(g,null,_(s.lgas,o=>(r(),n("option",{key:o,value:o},f(o),9,oe))),128))],512),[[F,s.form.city]]),i(p,{name:"city",class:"text-xs text-error"})])]),t("div",ae,[t("button",{class:x(["brand-btn w-8/12",[s.isLoading?"bg-gray1 text-gray":c.valid?"brand-primary":"bg-gray1 text-gray"]]),disabled:s.isLoading||!c.valid},[s.isLoading?(r(),j(m,{key:0,icon:"eos-icons:three-dots-loading",class:"text-xl text-gray2"})):(r(),n("span",le," Update "))],10,ie)]),re]),_:1},8,["onSubmit"]),ne,t("span",{class:"border border-dashed border-primary block p-2 rounded-md flex justify-between items-center",role:"button",onClick:a[6]||(a[6]=c=>e.$router.push("/app/kyc"))},[t("span",de,[i(m,{icon:"teenyicons:diamond-solid",class:"text-primary"}),t("div",ce,[me,t("span",pe,f(d.user.kyc_data?"Verified":"Not Verified"),1)])]),i(m,{icon:"prime:angle-right",class:"text-[25px]"})])])):w("",!0),s.activeTab=="1"?(r(),n("div",fe,[i(U,{items:s.reviews,onRefresh:d.getReviews},null,8,["items","onRefresh"])])):w("",!0)])])}const xe=k(R,[["render",ue]]);export{xe as default};
