import{_ as p,z as h,b as u,d as s,f as i,t as l,F as _,h as f,v as y,D as g,o as d}from"../entry/index.wkIW-Yay.js";const b={data(){return{items:[],loading:!1,isProductDetails:null,escrow:null}},methods:{getCartItems(){this.loading=!0,this.$user.cartList().then(t=>{console.log("data from products list:",t.data);let r=[];t.data.filter(e=>e.status).forEach(e=>{let n={...e.product,cart_id:e.id,offer_price:e.offer_price,quantity:e.quantity,session_id:e.session_id,status:e.status};r.push(n)}),this.items=r}).finally(()=>{this.loading=!1})},removeFromCart(){this.items.forEach(t=>{this.$user.removeFromCart(t.cart_id).then(r=>{console.log(r)})})},showProduct(t){console.log(t),this.$router.push(`/app/product/${t==null?void 0:t.id}`)},openProductDetails(t){this.isProductDetails=this.isProductDetails===t?null:t},checkOut(){const t=h();if(this.escrow==null)return t.error("Select a payment method",{timeout:4e3});let r={callback_url:window.location.origin+"/app/success",gateway:"paystack"},a={type:1,address:this.user.address,payment:1,escrow:String(this.escrow),description:"Pay for Order",...r};this.$orders.checkOut(a).then(e=>{console.log(e);let n=e.data.paymentUrl;console.log(e.data.paymentUrl),this.escrow?this.$router.push("/app/success"):window.open(n,"_parent")})},totalAmount(t){return t!=null&&t.offer_price?(t==null?void 0:t.offer_price)*(t==null?void 0:t.quantity):(t==null?void 0:t.base_price)*(t==null?void 0:t.quantity)}},beforeMount(){this.getCartItems()},computed:{user(){return this.$store.getters["auth/getUser"]},totalQty(){return this.items.reduce((a,e)=>a+e.quantity,0)},totalPrice(){return this.items.reduce((a,e)=>e.offer_price===null?a+e.quantity*e.offer_price:a+e.quantity*e.base_price,0)},protectionFee(){return .02*this.totalPrice},overallTotal(){return this.protectionFee+this.totalPrice}}},x={class:"lg:page-bg md:page-bg lg:w-6/12 md:w-7/12 w-full mx-auto"},v={class:"font-semibold"},w={class:"text-xs"},k=s("hr",{class:"my-2"},null,-1),P={class:"flex flex-col gap-5"},m=["src"],F={class:"flex gap-[4px] flex-col"},q=["onClick"],C={class:"flex gap-1 items-center"},$={class:"block text-sm"},I={class:"block text-[12px] font-semibold text-primary"},D=s("hr",{class:""},null,-1),O={class:"flex flex-col gap-1"},S={class:"text-xs flex justify-between"},T={class:"font-semibold"},U={class:"text-xs flex justify-between"},j={class:"font-semibold"},B=s("hr",{class:"my-2"},null,-1),M={class:"flex justify-between text-sm font-bold"},E={class:"font-bold"},V={class:"mt-3"},A=s("option",{value:null},"--Select payment Method--",-1),L=s("option",{value:1},"Pay with Wallet",-1),N=s("option",{value:0},"Pay Online",-1),W=[A,L,N],z=s("div",{class:"bg-accent p-3 mt-4"},[s("p",{class:"text-[13px]"}," For your protection, your payment will be held in a secure account until you've received your order and confirmed it's condition. "),s("p",{class:"text-[13px] mt-2"},[s("b",null,"Important:"),i(" We strongly advise arranging to meet the seller in a public place to inspect item before confirming receipt ")])],-1),Q={class:"text-center mt-4"};function G(t,r,a,e,n,c){return d(),u("div",x,[s("h4",v,[i("Checkout "),s("span",w,l(`(${n.items.length} items)`),1)]),k,s("div",P,[(d(!0),u(_,null,f(n.items,o=>(d(),u("div",{class:"flex gap-2",key:o==null?void 0:o.id},[s("img",{src:t.imgUrl+"product/"+(o==null?void 0:o.main_image),alt:"",role:"button",class:"h-[80px] w-[60px] object-contain rounded-lg"},null,8,m),s("div",F,[s("span",{class:"font-semibold block",role:"button",onClick:H=>t.$router.push(`/app/product/${o==null?void 0:o.id}`)},l(o==null?void 0:o.name),9,q),s("span",C,[s("span",$,l(t.$currencyFormat(c.totalAmount(o))),1),s("span",I,"x"+l(o==null?void 0:o.quantity),1)])])]))),128)),D,s("div",O,[s("span",S,[i("Sub Total: "),s("span",T,l(t.$currencyFormat(c.totalPrice)),1)]),s("span",U,[i("Buyers protection fee: "),s("span",j,l(t.$currencyFormat(c.protectionFee)),1)]),B,s("span",M,[i("Total: "),s("span",E,l(t.$currencyFormat(c.overallTotal)),1)])])]),s("div",V,[y(s("select",{"onUpdate:modelValue":r[0]||(r[0]=o=>n.escrow=o),name:"",id:"",class:"input"},W,512),[[g,n.escrow]])]),z,s("div",Q,[s("button",{onClick:r[1]||(r[1]=(...o)=>c.checkOut&&c.checkOut(...o)),class:"brand-btn brand-primary px-[30px] py-[10px]"}," Make Payment ")])])}const K=p(b,[["render",G]]);export{K as default};
