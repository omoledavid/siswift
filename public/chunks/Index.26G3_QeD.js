import{P as _}from"./ProductFilter.M2LWrCVv.js";import{_ as x,b as d,d as e,e as n,f as y,k as w,t as h,n as P,w as b,r as c,o as u}from"../entry/index.wkIW-Yay.js";const F={components:{ProductFilter:_},data(){return{isFilterOpen:!1,isProductDetails:null,items:[],locationItems:[],promotedItems:[],loading:!1,lat:"",long:"",payload:{state:""},search:{},searching:!1,drawer:!1,is_featured:"1"}},methods:{filterFunc(){function t(){return window.matchMedia("(max-width: 767px)").matches}t()?(console.log("You are using a mobile device"),this.drawer=!this.drawer):(console.log("You are using a desktop device"),this.isFilterOpen=!this.isFilterOpen)},closeFilter(){this.isFilterOpen=!1,this.searching=!1,this.drawer=!1,this.getUserLocation("refresh")},async getUserLocation(t){navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{this.lat=s.coords.latitude,this.long=s.coords.longitude,console.log(s,"Position"),this.$axios.get("https://nominatim.openstreetmap.org/reverse",{params:{lat:this.lat,lon:this.long,format:"json",addressdetails:1}}).then(r=>{console.log(r,"citry");let p=r.data.address.state.split(" ").length>2?r.data.address.state.split(" ").slice(0,2).join(" "):r.data.address.state.split(" ")[0];this.payload.state=p.toLowerCase(),this.getLocationProducts(t)})},s=>{this.error=s.message,console.error("Error getting location:",this.error)}):(this.error="Geolocation is not supported by this browser.",console.error(this.error))},showProduct(t){this.$router.push(`/app/product/${t==null?void 0:t.id}`)},openProductDetails(t){this.isProductDetails=this.isProductDetails===t?null:t},getProducts(){this.loading=!0,this.$products.list().then(t=>{this.items=t.data.products.data}).finally(()=>{this.loading=!1})},getLocationProducts(t){t||(this.loading=!0),this.$products.listByLocation(this.payload).then(s=>{this.locationItems=s.data}).finally(()=>{this.loading=!1})},getPromotedItems(t){let s={...this.payload,is_featured:this.is_featured};t||(this.loading=!0),this.$products.listByLocation(s).then(r=>{console.log(r,"promoted Items"),this.promotedItems=r.ads}).finally(()=>{this.loading=!1})}},beforeMount(){this.getProducts()},mounted(){this.getUserLocation()},watch:{"$route.query":{handler(t){if(Object.keys(t).length>0){console.log(t),this.payload=t,this.getLocationProducts(),this.getPromotedItems(),this.searching=!0;return}},immediate:!1,deep:!0}}},v={class:"body flex gap-4 items-start gap-4"},O={class:"col-span-3 body-content w-full"},C={class:"flex items-center justify-between"},k=e("h4",{class:"mb-3 font-semibold text-lg"},"Recommended Items",-1),V={class:"flex gap-3 items-center"},I={key:0,class:"flex justify-end gap-4"},L={key:0},R=e("h4",{class:"mb-3 font-bold text-[15px]"},h("Search Results"),-1),B=e("h4",{class:"mb-3 font-medium text-primary text-[15px]"},"Promoted Ads",-1),T={class:"mt-3"},N=e("h4",{class:"mb-3 font-medium text-primary text-[15px]"},"More Suggestions",-1),D={key:1},S={class:"mb-3 font-medium text-primary capitalize text-[15px]"},j={class:"mt-6"},M=e("h4",{class:"mb-3 font-medium text-primary text-[15px]"},h("More Suggestions"),-1),U={class:"p-6"},z={class:"mt-4 text-center"},A=["onClick"];function E(t,s,r,p,o,i){const g=c("i-icon"),a=c("wxProductCard"),m=c("ProductFilter"),f=c("Sidebar");return u(),d("div",v,[e("div",O,[e("div",C,[k,e("div",V,[e("button",{class:"brand-btn-md text-sm brand-primary flex gap-1 items-center",onClick:s[0]||(s[0]=l=>t.$router.push("/app/product/new"))}," Create Ad "),o.isFilterOpen?w("",!0):(u(),d("div",I,[e("button",{class:"brand-btn-md text-sm brand-primary flex gap-1 items-center",onClick:s[1]||(s[1]=(...l)=>i.filterFunc&&i.filterFunc(...l))},[n(g,{icon:"mdi:filter"}),y(" Filter ")])]))])]),o.searching?(u(),d("div",L,[R,e("div",null,[B,n(a,{loading:o.loading,products:o.promotedItems,isFilterOpen:o.isFilterOpen,hasButton:!1,iconType:"mdi:marketplace-outline",emptyText:"No promoted product foundðŸ˜¥",onViewProduct:i.showProduct,onRefresh:i.getLocationProducts},null,8,["loading","products","isFilterOpen","onViewProduct","onRefresh"])]),e("div",T,[N,n(a,{loading:o.loading,products:o.locationItems,isFilterOpen:o.isFilterOpen,hasButton:!1,iconType:"mdi:marketplace-outline",emptyText:"No product foundðŸ˜¥",onViewProduct:i.showProduct,onRefresh:i.getLocationProducts},null,8,["loading","products","isFilterOpen","onViewProduct","onRefresh"])])])):(u(),d("div",D,[e("div",null,[e("h4",S,h(`Within ${o.payload.state}`),1),e("div",null,[n(a,{loading:o.loading,products:o.locationItems,isFilterOpen:o.isFilterOpen,hasButton:!1,iconType:"mdi:marketplace-outline",emptyText:"No product in your areaðŸ˜¥",onViewProduct:i.showProduct,onRefresh:i.getLocationProducts},null,8,["loading","products","isFilterOpen","onViewProduct","onRefresh"])])]),e("div",j,[M,e("div",null,[n(a,{loading:o.loading,products:o.items,isFilterOpen:o.isFilterOpen,hasButton:!1,iconType:"mdi:marketplace-outline",emptyText:"No product FoundðŸ˜¥",onViewProduct:i.showProduct,onRefresh:i.getProducts},null,8,["loading","products","isFilterOpen","onViewProduct","onRefresh"])])])]))]),e("div",{class:P(["bg-white rounded-md filter-container min-h-[80vh]",[o.isFilterOpen?"w-[400px] p-6":"w-0 overflow-x-hidden hidden"]])},[n(m,{onClose:i.closeFilter},null,8,["onClose"])],2),n(f,{visible:o.drawer,"onUpdate:visible":s[2]||(s[2]=l=>o.drawer=l),position:"right",style:{width:"100%"}},{container:b(({closeCallback:l})=>[e("div",U,[n(m,{onClose:i.closeFilter},null,8,["onClose"]),e("div",z,[e("button",{class:"brand-btn-md text-sm brand-primary flex gap-1 items-center",onClick:l}," View Results ",8,A)])])]),_:1},8,["visible"])])}const G=x(F,[["render",E]]);export{G as default};
