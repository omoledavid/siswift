import{P as f}from"./ProductFilter.M2LWrCVv.js";import{_ as g,b as _,d as o,f as d,t as h,e as n,n as x,w as b,r as a,o as w}from"../entry/index.wkIW-Yay.js";const y={components:{ProductFilter:f},data(){return{filterData:{state:"",category:"",brand:"",search:"",sort:"",condition:"",date_listed:"",min_price:"",max_price:"",color:""},state:null,loading:!1,locationItems:[],promotedItems:[],isFilterOpen:!0,drawer:!1}},methods:{showProduct(t){this.$router.push(`/app/product/${t==null?void 0:t.id}`)},filterFunc(){this.drawer=!0},closeFilter(){this.drawer=!1},async getUserLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{this.lat=t.coords.latitude,this.long=t.coords.longitude,console.log(t,"Position"),this.$axios.get("https://nominatim.openstreetmap.org/reverse",{params:{lat:this.lat,lon:this.long,format:"json",addressdetails:1}}).then(e=>{console.log(e,"citry");let l=e.data.address.state.split(" ").length>2?e.data.address.state.split(" ").slice(0,2).join(" "):e.data.address.state.split(" ")[0];this.state=l,this.$router.push({query:{...this.$route.query,state:l}})})},t=>{this.error=t.message,console.error("Error getting location:",this.error)}):(this.error="Geolocation is not supported by this browser.",console.error(this.error))},getLocationProducts(t){t||(this.loading=!0),this.$products.listByLocation(this.filterData).then(e=>{console.log(e),this.locationItems=e.data,this.promotedItems=e.ads}).finally(()=>{this.loading=!1})}},watch:{"$route.query":{handler(t){if(Object.keys(t).length>0){console.log(t),this.filterData=t,this.getLocationProducts(),this.searching=!0;return}},immediate:!0,deep:!0},state:{handler(t){t&&this.$router.push({query:{...this.$route.query,state:this.state}})},immediate:!0}},beforeMount(){this.getUserLocation()},computed:{searchData(){return this.$route.query.search}}},P={class:"flex items-start gap-4 w-full"},v={class:"flex-1"},F={class:"flex justify-between items-start"},C={class:"mb-3 font-medium text-primary text-[18px]"},k={class:"text-[#000] capitalize font-bold"},O=o("h4",{class:"mb-3 font-medium text-primary text-[15px]"},"Promoted Ads",-1),D={class:"mt-3"},V=o("h4",{class:"mb-3 font-medium text-primary text-[15px]"},"More Suggestions",-1),L={class:"p-6"},R={class:"mt-4 text-center"},q=["onClick"];function B(t,e,l,I,s,i){const m=a("i-icon"),c=a("wxProductCard"),u=a("ProductFilter"),p=a("Sidebar");return w(),_("div",null,[o("div",P,[o("div",v,[o("div",F,[o("h4",C,[d(" Search Results for "),o("span",k,h(`"${s.filterData.search}"`),1),d(" "+h(`in ${s.filterData.state?s.filterData.state:s.state}`),1)]),o("button",{class:"lg:hidden md:hidden brand-btn-md text-sm brand-primary flex gap-1 items-center",onClick:e[0]||(e[0]=(...r)=>i.filterFunc&&i.filterFunc(...r))},[n(m,{icon:"mdi:filter"}),d(" Filter ")])]),o("div",null,[O,n(c,{loading:s.loading,products:s.promotedItems,isFilterOpen:s.isFilterOpen,hasButton:!1,iconType:"mdi:marketplace-outline",emptyText:"No promoted product foundðŸ˜¥",onViewProduct:i.showProduct,onRefresh:i.getLocationProducts},null,8,["loading","products","isFilterOpen","onViewProduct","onRefresh"])]),o("div",D,[V,n(c,{loading:s.loading,products:s.locationItems,isFilterOpen:s.isFilterOpen,hasButton:!1,iconType:"mdi:marketplace-outline",emptyText:"No product foundðŸ˜¥",onViewProduct:i.showProduct,onRefresh:i.getLocationProducts},null,8,["loading","products","isFilterOpen","onViewProduct","onRefresh"])])]),o("div",{class:x(["bg-white rounded-md filter-container min-h-[80vh] lg:block md-block hidden",[s.isFilterOpen?"w-[400px] p-6":"w-0 overflow-x-hidden hidden"]])},[n(u,{onClose:e[1]||(e[1]=r=>t.$router.go(-1))})],2)]),n(p,{visible:s.drawer,"onUpdate:visible":e[2]||(e[2]=r=>s.drawer=r),position:"right",style:{width:"100%"}},{container:b(({closeCallback:r})=>[o("div",L,[n(u,{onClose:r},null,8,["onClose"]),o("div",R,[o("button",{class:"brand-btn-md text-sm brand-primary flex gap-1 items-center",onClick:r}," View Results ",8,q)])])]),_:1},8,["visible"])])}const T=g(y,[["render",B]]);export{T as default};
